# 票小秘（BillMii）- Android端票据文件整理分类程序开发计划（plan.md）

# 票小秘（BillMii）- Android端票据文件整理分类程序（本地OCR+财会报销版）开发计划

## 文档说明

本文档为Android端票据文件整理分类程序「票小秘（BillMii）」的开发规划，涵盖核心定位、技术架构、功能模块、非功能需求及实施优先级，用于AI代码工具生成项目代码，同时适配财会行业业务流程与移动端开发规范。

### 项目中英文名称说明

1.  中文名称：票小秘
    寓意：聚焦票据处理场景，“小秘”拟人化凸显高效辅助属性，贴合移动端轻量化工具调性，降低C端用户使用门槛。

2.  英文名称：BillMii（首选）
    适配逻辑：① 谐音贴合：“Bill”对应“票”（票据核心场景），“Mii”谐音“秘”，读音顺口易记；② 形态适配：简洁短字符（5个字母），适合Android端APP图标展示、应用商店搜索；③ 属性匹配：无歧义、无不良联想，符合财会工具专业感，同时自带亲和度；④ 扩展性：可作为APP包名前缀（如com.billmii.android），便于品牌统一。

3.  备选英文名称（适配特殊场景）
    - BillPal：“Pal”意为伙伴，凸显辅助属性，口语化强，适合面向个体用户的工具定位；
    - BillMate：“Mate”指助手、搭档，适配财会协同场景，专业度略高于BillPal。

## 一、核心定位与设计原则

### 1.1 核心定位

面向Android端C端财会人员、行政岗，以“本地处理为核心、OCR精准识别为支撑”，结合移动端便携特性，实现票据/文件采集、识别、分类、归档、报销申报、账务适配全流程自动化，解决手工录入繁琐、分类混乱、数据安全泄露、移动端办公适配不足等痛点，贴合企业财会标准化规范。

### 1.2 设计原则

- **本地优先**：OCR识别、数据存储、流程处理全环节本地完成，无云端传输，规避财务数据泄露风险，符合财会保密要求。

- **财会适配**：贴合票据审核、费用归集、报销合规校验、账务对接等财会核心流程，适配高频票据类型与企业报销规范。

- **精准高效**：优化本地OCR引擎对财会票据的识别精度（适配移动端拍摄场景），支持批量处理，减少人工干预。

- **可扩展性**：支持自定义分类规则、报销流程、字段提取模板，适配小微企业、个体工商户等不同主体的财会需求。

## 二、核心架构规划

### 2.1 技术架构（本地部署，适配Android端）

1. **本地基础层**

    - 系统适配：Android 10及以上版本

    - 核心组件：轻量本地OCR引擎（离线识别、适配移动端算力）、Android加密沙箱数据库（存储票据数据、分类规则、报销记录，隔离第三方访问）、文件解析模块（支持PDF、JPG、PNG、TIFF格式，适配移动端文件读取规范）

2. **核心服务层**

    - 核心服务：OCR识别服务（优化移动端图像适配，支持倾斜、轻微模糊场景）、智能分类服务、报销流程服务、账务对接服务（局域网互联本地财务软件）、数据加密服务（适配Android系统安全框架）

3. **交互层**

    - 载体：Android端主应用（唯一操作入口，支持竖屏/横屏切换）

    - 功能集成：相机采集、本地文件读取、蓝牙/局域网传输，适配手机/平板设备与触控操作习惯

### 2.2 核心业务流程

票据/文件采集 → 本地OCR识别与字段提取 → 智能分类归档（自动/手动修正） → 报销单生成与合规校验 → 报销审核流转（C端个人/小团队） → 账务数据导出/对接 → 历史数据检索与备份

## 三、核心功能模块开发要点

### 模块一：票据与文件采集

#### 核心目标：多渠道轻量化采集，支持批量处理，适配移动端操作

1. **多源导入**

    - 本地文件导入：读取手机存储/SD卡内单文件/批量票据，基于文件哈希值校验过滤重复文件，适配Android存储权限分级管理。

    - 相机直采：集成相机模块，支持一键拍摄、连续拍摄，自动完成图像预处理（去模糊、纠偏、裁边、阴影去除）；支持扫码识别电子发票二维码（本地读取，无云端传输）；支持蓝牙对接便携式移动端扫描仪，实时导入扫描件。

    - 跨端同步导入：通过局域网（WiFi直连）从电脑端/其他Android设备批量传输票据，全程本地流转。

2. **采集预处理**：基于移动端算力优化图像处理（灰度增强、降噪、格式统一为PDF/图片），支持手动拖动裁剪、旋转、放大操作，适配触控交互。

### 模块二：本地OCR识别与解析

#### 核心目标：精准提取财会关键字段，支持人工修正，适配移动端展示

1. **票据类型适配**：预设高频票据识别模板，优化移动端拍摄场景适配


    - 发票类：增值税专票/普票（电子/纸质）、机动车销售发票、二手车发票

    - 费用类：火车票、飞机行程单、汽车票、出租车票、住宿费/餐饮发票

    - 其他类：报销单、收据、银行回单、合同扫描件、工资表、费用明细表

2. **关键字段提取**：自动提取结构化数据，适配移动端屏幕展示与编辑
        

    - 发票类：发票代码、发票号码、开票日期、购销双方名称/税号、金额（价税合计/不含税）、税率、税额、发票状态（本地规则校验）

    - 费用类：日期、起止地、金额、开票方、费用类型（差旅/餐饮/住宿）

    - 通用字段：文件名称、识别时间、关联报销单编号、归档路径、存储位置（手机内存/SD卡）

3. **识别优化与修正**

    - 精度保障：内置财会字段校验规则（发票代码位数、税额计算、日期格式），高亮弹窗提示可疑字段。

    - 人工修正：触控式编辑界面，支持单字段点击修改、本地语音输入补充，修正后同步更新数据。

    - 模板自定义：支持触控标注自定义票据字段位置，轻量训练本地OCR模型，适配企业专属票据。

    **开源库选型及适配要点**（适配Android本地部署，优先满足财会票据识别精度与性能）
                  **首选库：PaddleOCR（推荐版本：PP-OCRv5 Mobile）**核心优势：中文识别精度行业领先（财会票据中文识别率达98.7%），适配移动端轻量化需求，提供8.6MB超轻量模型，单张票据识别耗时≤3秒，满足项目性能要求；支持文本检测、方向矫正、字段提取全流程，完美适配倾斜、轻微模糊的票据场景（贴合移动端拍摄特点）；开源协议友好（Apache 2.0），中文文档齐全，百度官方维护，社区活跃，AI code工具易生成适配代码。

    Android适配方案：集成PaddleOCR Android SDK，选用PP-OCRv5 Mobile轻量模型（支持CPU离线推理，无需GPU依赖）；通过JNI接口调用C++核心模块，优化移动端算力占用；预设财会票据识别模板，基于官方模型微调发票、行程单等字段识别规则，提升税号、金额、日期等关键信息提取准确率。

    开发注意事项：依赖飞桨PaddlePaddle Android框架，需配置gradle依赖与权限；模型文件放置于Android assets目录，首次启动加载至本地沙箱，避免重复加载；结合OpenCV做前置图像处理（二值化、降噪），进一步提升识别精度。

    **备选库：RapidOCR**核心优势：跨平台轻量开源库，融合ONNXRuntime推理引擎，Android端部署体积小、启动快；支持直接适配PaddleOCR预训练模型，可复用财会票据微调成果；推理速度优于传统OCR库，批量识别效率适配移动端需求。

    适配场景：当PaddleOCR框架依赖过多时备选，适合追求极致轻量化、低内存占用的场景，可通过模型转换工具将PaddleOCR微调模型转为ONNX格式，接入RapidOCR引擎。

    **排除库说明**：Tesseract OCR（复杂票据识别精度不足，需手动大量预处理，适配成本高）、EasyOCR（模型体积大（300MB+），移动端内存占用过高）、MMOCR（上手门槛高，深度学习依赖重，不适配移动端快速开发）。

### 模块三：智能分类与归档

#### 核心目标：财会标准化分类，可追溯归档，灵活检索

1. **多级分类规则**

    - 系统预设分类（贴合财会逻辑）：
                

        - 一级：收入类票据、支出类票据、费用类票据、合同文件、账务凭证、其他文件

        - 二级：支出类→采购/费用/资产支出；费用类→差旅费/办公费/业务招待费/福利费

    - 自定义分类：支持按部门、项目、供应商、会计期间新增维度，设置条件规则（如“金额>1000元+差旅费”归为大额差旅支出）。

    - 自动触发：OCR识别后按字段匹配规则归档，支持手动调整、批量移动文件。

2. **归档管理**

    - 结构化归档：生成唯一编号（年份-月份-分类编码-流水号），关联OCR字段形成台账，支持Excel导出。

    - 版本管理：保留原始文件与修正后数据，记录修改轨迹（操作人、时间、内容），符合财会可追溯要求。

3. **快速检索**：支持多条件组合检索（发票号、金额范围、日期、分类）、全文检索（OCR内容），结果可预览、导出、批量操作，支持排序。

### 模块四：报销管理

#### 核心目标：票据关联报销，合规校验，轻量审核流转

1. **报销单生成**

    - 自动关联：勾选归档票据，自动汇总金额，生成标准化报销单（含报销人、部门、事由、票据清单、合计金额）。

    - 编辑适配：手动补充报销信息，调整票据清单，自动重算金额；提供多套模板（个人/团队/项目），支持自定义字段。

2. **报销合规校验（本地规则配置）**

    - 基础校验：票据有效性、金额一致性，卡片式展示结果。

    - 标准校验：配置企业费用标准（住宿上限、招待费比例），标记超标准金额，提供触控式补充说明入口。

    - 完整性校验：检查必要票据是否缺失，标记缺失项并支持一键跳转补充。

3. **审核流转（C端轻量版）**

    - 流程配置：自定义审核节点（如“提交→部门审核→财务审核→付款确认”），本地导入联系人分配角色。

    - 流转通知：应用弹窗、本地消息推送提醒，支持触控查看意见、票据批注（手写/高亮）。

    - 状态追踪：进度条展示状态（待审核/审核中/通过/退回），退回后可一键修改重提。

4. **报销凭证生成**：审核通过后生成PDF凭证（含报销单、清单、审核意见），本地配置电子签章，自动归档，支持打印。

### 模块五：账务对接与数据导出

#### 核心目标：打通财会账务环节，减少手动录入

1. **数据导出功能**

    - 结构化导出：台账、报销单数据导出为Excel/CSV（适配财务软件模板），含完整字段。

    - 凭证导出：批量打包报销凭证与原始票据，按编号/日期分类。

    - 自定义导出：筛选字段、范围，生成符合账务要求的报表。

2. **本地财务软件对接**

    - 适配软件：金蝶KIS、用友T3/T6、管家婆

    - 对接方式：局域网API导入数据生成记账凭证；无直连API时，导出至存储设备后拷贝至电脑端软件。

    - 账务核对：导出核对表，支持移动端预览或局域网同步至电脑精细化核对。

### 模块六：数据安全与备份

#### 核心目标：保障本地财务数据安全，符合财会留存要求

1. **本地数据加密**

    - 存储加密：Android加密沙箱+AES算法双重加密，仅应用可访问，防Root设备非法读取。

    - 访问控制：支持登录密码、指纹/面容解锁，配置操作权限（查看/编辑/导出），多账号本地切换。

2. **备份与恢复**

    - 自动备份：定时备份（每日/每周），加密存储至手机/SD卡/局域网电脑。

    - 手动备份：一键备份全量数据，生成日志；支持从本地/局域网备份文件恢复，可视化展示进度。

3. **操作日志**：记录全操作轨迹（采集、识别、报销、导出等），含操作人、时间、内容，日志不可删除，支持条件查询，适配审计要求。

### 模块七：辅助功能

1. **统计分析**：生成可视化报表（饼图/柱状图），展示费用占比、部门支出、报销进度，支持多维度筛选。

2. **批量操作**：批量修改分类、删除重复票据、导出报销单，适配触控批量选择。

3. **个性化设置**：配置OCR精度（快速/精准）、分类规则、报销流程、备份路径、文件命名规则。

## 四、非功能需求（开发约束）

1. **性能要求**：单张票据OCR识别≤5秒，50张内批量识别≤1分钟；应用启动≤3秒，检索响应≤1秒，无卡顿、闪退。

2. **兼容性要求**：适配Android 10+，覆盖主流品牌手机/平板，支持不同分辨率；兼容PDF、JPG、PNG、TIFF格式。

3. **易用性要求**：触控优先设计，核心功能操作步骤≤3步；提供新手引导弹窗、离线操作手册。

4. **合规性要求**：符合《会计档案管理办法》，支持电子票据签章本地验证；遵循Android隐私政策，不收集无关数据。

## 五、实施优先级规划（分阶段开发）

1. **一期（核心必备，优先开发）**
Android端相机采集/本地文件导入 + 基础OCR识别（发票/费用类票据） + 预设分类归档 + 简单报销单生成 + 本地加密存储与备份 + 基础数据导出。

2. **二期（功能优化）**
OCR模板自定义（触控标注） + 报销合规校验 + 轻量审核流转（本地推送） + 局域网财务软件对接 + 移动端可视化统计。

3. **三期（体验升级）**
生物识别强化 + 高级检索（语音/多维度） + 批量操作工具 + 个性化配置 + 电子签章验证 + 跨设备局域网同步。

## 六、开发适配说明

- 所有功能均基于本地开发，避免依赖云端服务，确保数据安全与离线可用。

- 触控交互适配：按钮、编辑框、列表等控件适配移动端屏幕尺寸，支持单手操作。

- 权限管理：严格遵循Android存储、相机、蓝牙等权限申请规范，仅申请功能必需权限。

## 七、OCR功能开发补充说明

- 模型部署：优先将PaddleOCR PP-OCRv5 Mobile模型打包至应用安装包，避免联网下载，确保离线可用；支持模型本地更新（通过局域网同步微调后模型），不依赖云端。

- 性能优化：Android端开启多线程推理，结合设备CPU核心数动态分配任务；识别前对票据图像进行尺寸压缩（保持关键信息清晰前提下），降低算力消耗。

- 兼容性适配：针对不同Android机型（高低配），提供“精准模式”（默认，启用完整模型）与“快速模式”（低配机型可选，简化模型推理），平衡精度与速度。
> （注：文档部分内容可能由 AI 生成）